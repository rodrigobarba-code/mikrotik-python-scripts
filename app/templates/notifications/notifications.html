{% extends 'base.html' %}

{% block title %} Notifications {% endblock %}

{% block head %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/notifications/styles.css') }}">
{% endblock %}
{% block scripts %}
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.9/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.9/plugin/relativeTime.js"></script>
    <script src="{{ url_for('static', filename='js/notifications/scripts.js') }}"></script>
{% endblock %}

{% block content %}
    <div class="container mx-auto">
        <div class="container w-75 jumbotron-notifications">
            <div class="row">
                <div class="d-flex flex-column col-12 col-md-12 col-lg-12 p-4 justify-content-center align-items-center">
                    <h2 class="notifications-title"><b>Notifications</b> Center</h2>
                    <hr class="notifications-hr" style="width: 75%; color: #f8f9fa; height: 2px;">
                    <p class="notifications-subtitle">Here you can view the notifications of the system.</p>
                    <p class="notifications-subtitle">Also, you can archive the notifications that you have already
                        read.</p>
                </div>
            </div>
        </div>

        <div class="container jumbotron-notifications w-75 mt-2">
            <div class="row">
                <div class="d-flex flex-row col-12 col-md-12 col-lg-12 m-2 justify-content-end align-items-center">
                    <button type="button" id="show-archived" class="btn btn-md me-2" data-bs-target="#delete-all-modal">
                        Show Archived
                    </button>
                </div>
            </div>
        </div>

        <div class="container notifications-container w-50 mt-4">
            {% if notification_list %}
                {% for notification in notification_list %}
                    {% if notification.is_archived == 0 %}
                        <div class="d-flex align-items-center notification">
                            <div class="box ms-2 me-2">
                                {% set c = '' %}
                                {% if notification.notification_type == 'error' %}
                                    {% set c = '#f50b0b' %}
                                {% elif notification.notification_type == 'warning' %}
                                    {% set c = '#f5a50b' %}
                                {% elif notification.notification_type == 'success' %}
                                    {% set c = '#4df50b' %}
                                {% else %}
                                    {% set c = '#3b82f6' %}
                                {% endif %}
                                <i class="bell fa-duotone fa-solid fa-bell" style="color: {{ c }}; font-size: 40px"></i>
                            </div>
                            <div class="box ms-2 mt-3">
                                <h4 class="notification-title">
                                    {% if notification.notification_type == 'error' %}
                                        Error
                                    {% elif notification.notification_type == 'warning' %}
                                        Warning
                                    {% elif notification.notification_type == 'success' %}
                                        Success
                                    {% else %}
                                        Information
                                    {% endif %}
                                </h4>
                                <p class="notification-content">{{ notification.notification_title }}</p>
                                <p class="notification-datetime" data-datetime="{{ notification.notification_datetime }}"></p>
                            </div>
                            <div class="box ms-auto">
                                <!-- Button to show more details -->
                                <button type="button"
                                        class="btn btn-custom btn-md show-details-btn"
                                        data-body="{{ notification.notification_body }}">
                                    <i style="color: #3b82f6" class="fa-duotone fa-solid fa-file-magnifying-glass"></i>
                                </button>
                                <!-- Button to archive the notification -->
                                <button type="button" class="btn btn-custom btn-md" id="archive-notification">
                                    <i style="color: #75cc64" class="fa-duotone fa-solid fa-box-archive"></i>
                                </button>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% else %}
                <div style="color: white" class="d-flex flex-column align-items-center pt-4">
                    <i class="fa-duotone fa-solid fa-bell-slash mb-2" style="color: #f8f9fa; font-size: 50px"></i>
                    <h2 class="notifications-title">No notifications found</h2>
                    <p class="notifications-subtitle">There are no notifications to show.</p>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
